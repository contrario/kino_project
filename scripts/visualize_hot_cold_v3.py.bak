import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import time
import os

start_time = time.time()

# Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ·Ï‚
sns.set(style='whitegrid')
plt.rcParams['axes.labelsize'] = 10
plt.rcParams['axes.titlesize'] = 12

# Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Ï†Î±ÎºÎ­Î»Î¿Ï… Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·Ï‚
os.makedirs('charts', exist_ok=True)

# Î¡ÏÎ¸Î¼Î¹ÏƒÎ·: Î ÏŒÏƒÎ¿Î¹ Î±ÏÎ¹Î¸Î¼Î¿Î¯ Î½Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ Î±Î½Î¬ Î³ÏÎ¬Ï†Î·Î¼Î±
TOP_N = 20

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import time
import os

start_time = time.time()
sns.set(style='whitegrid')
plt.rcParams['axes.labelsize'] = 10
plt.rcParams['axes.titlesize'] = 12

os.makedirs('charts', exist_ok=True)
TOP_N = 20

# Î‘Î½Î¬Î³Î½Ï‰ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½
df = pd.read_csv('results/number_frequency.csv')
df = df.sort_values(by='Frequency', ascending=False)

# âœ… Î“ÏÎ¬Ï†Î·Î¼Î± 1: Î£Ï…Î½Î¿Î»Î¹ÎºÎ® ÏƒÏ…Ï‡Î½ÏŒÏ„Î·Ï„Î±
plt.figure(figsize=(14, 6))
sns.barplot(data=df.head(TOP_N), x='Number', y='Frequency', hue='Number', palette='viridis', dodge=False, legend=False)
plt.title(f'Top-{TOP_N} Î‘ÏÎ¹Î¸Î¼Î¿Î¯ Î¼Îµ Ï„Î· ÎœÎµÎ³Î±Î»ÏÏ„ÎµÏÎ· Î£Ï…Ï‡Î½ÏŒÏ„Î·Ï„Î±')
plt.xlabel('Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚')
plt.ylabel('Î£Ï…Ï‡Î½ÏŒÏ„Î·Ï„Î±')
plt.xticks(rotation=0)

for index, row in df.head(TOP_N).iterrows():
    plt.text(x=index, y=row['Frequency'] + 0.5, s=row['Frequency'], ha='center', fontsize=8)

plt.tight_layout(pad=1.5)
plt.savefig('charts/all_frequencies.png')
plt.savefig('charts/all_frequencies.pdf')
plt.close()

# âœ… Î“ÏÎ¬Ï†Î·Î¼Î± 2: Hot Numbers
df_hot = pd.read_csv('results/hot_numbers.csv')
df_hot = df_hot.sort_values(by='Frequency', ascending=False)

plt.figure(figsize=(10, 5))
sns.barplot(data=df_hot, x='Number', y='Frequency', hue='Number', palette='Reds', dodge=False, legend=False)
plt.title('Top-10 Hot Î‘ÏÎ¹Î¸Î¼Î¿Î¯')
plt.xlabel('Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚')
plt.ylabel('Î£Ï…Ï‡Î½ÏŒÏ„Î·Ï„Î±')

for index, row in df_hot.iterrows():
    plt.text(x=index, y=row['Frequency'] + 0.5, s=row['Frequency'], ha='center', fontsize=8)

plt.tight_layout(pad=1.5)
plt.savefig('charts/hot_numbers.png')
plt.savefig('charts/hot_numbers.pdf')
plt.close()

# âœ… Î“ÏÎ¬Ï†Î·Î¼Î± 3: Cold Numbers
df_cold = pd.read_csv('results/cold_numbers.csv')
df_cold = df_cold.sort_values(by='Frequency', ascending=False)

plt.figure(figsize=(10, 5))
sns.barplot(data=df_cold, x='Number', y='Frequency', hue='Number', palette='Blues', dodge=False, legend=False)
plt.title('Top-10 Cold Î‘ÏÎ¹Î¸Î¼Î¿Î¯')
plt.xlabel('Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚')
plt.ylabel('Î£Ï…Ï‡Î½ÏŒÏ„Î·Ï„Î±')

for index, row in df_cold.iterrows():
    plt.text(x=index, y=row['Frequency'] + 0.5, s=row['Frequency'], ha='center', fontsize=8)

plt.tight_layout(pad=1.5)
plt.savefig('charts/cold_numbers.png')
plt.savefig('charts/cold_numbers.pdf')
plt.close()

# Î¤ÎµÎ»Î¹ÎºÏŒ Î¼Î®Î½Ï…Î¼Î±
duration = round(time.time() - start_time, 2)
print("âœ… ÎŸÎ»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ Î³ÏÎ±Ï†Î·Î¼Î¬Ï„Ï‰Î½ (v3) Ï‡Ï‰ÏÎ¯Ï‚ warnings.")
print("ğŸ“‚ Î‘Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎ±Î½ ÏƒÎµ PNG ÎºÎ±Î¹ PDF ÏƒÏ„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿ 'charts/'")
print(f"â±ï¸ Î§ÏÏŒÎ½Î¿Ï‚ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·Ï‚: {duration} sec")

