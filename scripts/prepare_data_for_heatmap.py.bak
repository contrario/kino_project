import pandas as pd
import os

print("ğŸ”„ Î ÏÎ¿ÎµÏ„Î¿Î¹Î¼Î±ÏƒÎ¯Î± Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Î³Î¹Î± heatmap...")

# ğŸ”¹ Î”Î¹Î±Î´ÏÎ¿Î¼Î® Î±ÏÏ‡Î¹ÎºÎ¿Ï Î±ÏÏ‡ÎµÎ¯Î¿Ï…
input_path = os.path.join("..", "data", "kino_data.csv")
output_path = os.path.join("..", "data", "kino_data_prepared.csv")

# ğŸ”¹ Î”Î¹Î±Î²Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿
df = pd.read_csv(input_path)

# ğŸ”¹ ÎœÎµÏ„Î¿Î½Î¿Î¼Î±ÏƒÎ¯Î± ÏƒÏ„Î·Î»ÏÎ½ num_1 â†’ number_1
num_cols = {f'num_{i}': f'number_{i}' for i in range(1, 21)}
df.rename(columns=num_cols, inplace=True)

# ğŸ”¹ Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ÏƒÏ„Î®Î»Î·Ï‚ "hour" Î±Ï€ÏŒ Ï„Î¿ draw_time
df['draw_time'] = pd.to_datetime(df['draw_time'])
df['hour'] = df['draw_time'].dt.hour

# ğŸ”¹ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÏƒÎµ Î½Î­Î¿ Î±ÏÏ‡ÎµÎ¯Î¿
df.to_csv(output_path, index=False)

print(f"âœ… Î¤Î¿ Î½Î­Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎµ Ï‰Ï‚: {output_path}")
